<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrimeBite Fishing ‚Äî Walleye Transparency</title>
  <meta name="description" content="PrimeBite Fishing ‚Äî Walleye full transparency: equations, variables, citations, exact quotes with page pointers, and calibration rationale.">
  <meta name="theme-color" content="#1a1a1a">
  <link rel="canonical" href="https://primetimefishing.app/walleye">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #e0e0e0;
      background: #1a1a1a;
    }
    .container { max-width: 980px; margin: 0 auto; padding: 0 20px; }
    .header {
      background: rgba(26, 26, 26, 0.95);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid #333;
    }
    .nav { display: flex; justify-content: center; gap: 1.25rem; padding: 1rem 0; flex-wrap: wrap; }
    .nav a { color: #e0e0e0; text-decoration: none; font-weight: 600; }
    .nav a:hover { color: #4a9eff; }
    .section { padding: 44px 0; }
    h1 { font-size: 2rem; line-height: 1.2; color: #fff; margin-bottom: 10px; }
    h2 { font-size: 1.6rem; color: #fff; margin: 28px 0 12px; }
    h3 { font-size: 1.2rem; color: #4a9eff; margin: 20px 0 10px; }
    p { margin-bottom: 12px; color: #b0b0b0; }
    ul { margin: 8px 0 16px 20px; color: #b0b0b0; }
    li { margin-bottom: 6px; }
    a { color: #4a9eff; }
    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    pre {
      background: #121212;
      border: 1px solid #333;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
      margin: 10px 0 16px;
      color: #e0e0e0;
    }
    blockquote {
      background: #2a2a2a;
      border-left: 4px solid #4a9eff;
      padding: 12px;
      margin: 10px 0 16px;
      border-radius: 6px;
      color: #e0e0e0;
    }
    .pill {
      display: inline-block;
      font-size: 12px;
      padding: 4px 10px;
      border: 1px solid #333;
      border-radius: 999px;
      margin-right: 8px;
      color: #b0b0b0;
      background: #202020;
    }
    .toc {
      margin: 14px 0 22px 0;
      padding: 14px;
      border: 1px solid #333;
      border-radius: 10px;
      background: rgba(255,255,255,0.03);
      color: #b0b0b0;
    }
    .toc strong { color: #e0e0e0; }
    .footer { border-top: 1px solid #333; padding: 20px 0; color: #666; text-align: center; }
    .print-button {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: #4a9eff;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(74, 158, 255, 0.3);
      transition: all 0.2s;
      z-index: 1000;
    }
    .print-button:hover {
      background: #3a8eef;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(74, 158, 255, 0.4);
    }
    @media print {
      .header, .print-button { display: none; }
      body { background: #fff; color: #000; }
      .container { max-width: 100%; }
      a { color: #000; text-decoration: underline; }
      pre, blockquote { page-break-inside: avoid; }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container">
      <nav class="nav">
        <a href="/">Home</a>
        <a href="/#transparency">Transparency</a>
        <a href="#math">Math</a>
        <a href="#variables">Variables</a>
        <a href="#example">Worked example</a>
        <a href="#changelog">Changelog</a>
      </nav>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <span class="pill">PrimeBite Fishing</span>
      <span class="pill">Walleye</span>
      <span class="pill">Full Transparency</span>

      <h1>Walleye ‚Äî Full Transparency (v1)</h1>
      <p><em>Last updated: 2026-01-30</em></p>

      <p>
        This page is designed to leave nothing out: the exact equations, every variable we use, the open-access URLs behind each driver,
        verbatim quotes (with page pointers where available), and a plain-English explanation of what is research-backed vs what is calibrated.
      </p>

      <div class="toc">
        <strong>On this page</strong>
        <ul>
          <li><a href="#math">The exact math (Walleye v1)</a></li>
          <li><a href="#variables">Variables (research-backed vs calibrated)</a></li>
          <li><a href="#calculation-methodology">Calculation methodology</a></li>
          <li><a href="#verification">Key definitions & verification sources</a></li>
          <li><a href="#example">Worked example</a></li>
          <li><a href="#changelog">Model changelog</a></li>
        </ul>
      </div>

      <h2 id="math">The exact math (Walleye v1)</h2>
      <p>
        Walleye (v1) is a freshwater <strong>Major-window</strong> rating: each Major solunar window (moon overhead / underfoot) gets a 1.0‚Äì5.0 score,
        and the day score is the duration-weighted average of the Major-window scores.
      </p>

      <pre><code>// Lift-to-rating map (global)
L_total_clamped = clamp(L_total, 0, L_REF)          // where L_REF = 0.28
raw_rating = 1 + 4 √ó (L_total_clamped / L_REF)      // then clamped to [1.0, 5.0]

// Walleye window lift (per Major window; Walleye v1 uses Majors only)
L_total_raw = L_base + L_phase + L_overlap + L_time // (wind/precip/pressure disabled for Walleye v1)

// Seasonality multiplier (capped)
L_total = clamp(L_total_raw √ó seasonMult, 0, L_REF) // seasonMult capped to 1.15

// Percentile-mapped display rating (commercial/UI mapping)
// We map seasonal lift percentiles ‚Üí 1.0‚Äì5.0 so 1.0 and 5.0 are equally rare.
display_rating = percentileMap(L_total)</code></pre>

      <p>
        Key idea: <strong>research chooses the drivers</strong> (what matters), then we <strong>calibrate</strong> the exact sizes and caps so the output
        is stable, explainable, and consistently mapped into 1.0‚Äì5.0.
      </p>

      <h2 id="calculation-methodology">Calculation methodology</h2>
      <p>
        This is the ‚Äúhow it‚Äôs calculated‚Äù reference for Walleye v1.
      </p>

      <pre><code>Step 1) Base lift (Majors only)
L_base = 0.10 for Major (moon overhead/underfoot)

Step 2) Moon phase lift
phaseBoostValue = moonPhaseBoostWalleyeGibbous(moonPhasePosition)
L_phase = (phaseBoostValue √ó phaseWeight / 2.0) √ó 0.05     // phaseWeight = 2.0 (calibrated)

Step 3) Dawn/dusk overlap lift (civil twilight overlap)
overlap_fraction = overlap(period, civil_twilight_window)  // 0.0..1.0
L_overlap = 0.07 √ó overlap_fraction                        // 0..0.07 (calibrated ceiling)

Step 4) Time lift (low-light + cloud-cover proxy)
// Low-light factor is step-like within ¬±30 minutes (Vasquez 2024 definition)
dawnFactor = lowLightFactorToTime(center, sunrise, 30, 30)  // ~1 inside 30 min; ~0 outside
duskFactor = lowLightFactorToTime(center, sunset, 30, 30)
ll = max(dawnFactor, duskFactor √ó duskLowLightMultiplier)  // dusk slightly weighted (calibrated)

// Cloud cover is used as a proxy for mean daily solar radiation (Shaw 2021):
// we use daytime-average cloud cover (‚âà9am‚Äì3pm local) when available.
timeBias = (ll √ó lowLightBias) + (cloudCover/100 √ó cloudCoverBias)
L_time = (timeBias / 0.40) √ó 0.03                           // small by design

Step 5) Apply seasonal multiplier
L_total = clamp((L_base + L_phase + L_overlap + L_time) √ó seasonMult, 0, L_REF)

Step 6) Lift ‚Üí raw rating (lift-based)
raw_rating = 1 + 4 √ó (L_total / 0.28)

Step 7) Raw lift ‚Üí percentile-mapped display rating (commercial/UI)
display_rating = piecewiseLinearMap(L_total; p01‚Üí1.0, p05‚Üí1.3, p50‚Üí2.5, p95‚Üí4.7, p99‚Üí5.0)</code></pre>

      <h3>Percentile mapping (why Walleye windows can reach 1.0 and 5.0)</h3>
      <p>
        The Walleye model drivers are research-backed (Shaw 2021 + supporting definitions). However, the research does not support
        a ‚Äúnearly impossible‚Äù biological floor for Walleye. Because this is a commercial app and users expect a true 1‚Äì5 scale,
        we apply a transparent <strong>percentile mapping</strong> for <strong>Major-window display ratings</strong>.
      </p>
      <p>
        <strong>Important:</strong> in PrimeBite Walleye, <strong>1.0 means ‚Äúworst predicted conditions relative to the benchmark population,‚Äù</strong>
        not ‚Äúyou will catch nothing.‚Äù
      </p>
      <p><strong>Benchmark population used:</strong> all freshwater benchmark locations in <code>docs/benchmark/locations.json</code>, full year 2026, daily sampling, no weather injected.</p>
      <p><strong>Seasonal lift percentiles (L_total after seasonality):</strong></p>
      <pre><code>p01 = 0.095000
p05 = 0.100000
p50 = 0.123638
p95 = 0.158084
p99 = 0.170993</code></pre>

      <h2 id="variables">Variables (what‚Äôs research-backed vs calibrated)</h2>
      <p>
        <strong>Research-backed</strong> means the driver/pattern/mechanism is supported by open-access sources.
        <strong>Calibrated</strong> means we chose the exact thresholds/weights/caps to make a stable 1‚Äì5 score and to avoid dominance/double-counting.
      </p>

      <h3 id="var-moon-position">Moon position (Majors only) (L_base)</h3>
      <p><strong>Research-backed:</strong> Walleye trip success is ~10‚Äì12% higher when the moon is overhead/underfoot.</p>
      <p><strong>Calibrated:</strong> mapping ‚Äú~10‚Äì12%‚Äù into a lift constant (0.10 for Majors).</p>
      <p><strong>Source (open access):</strong> <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0257882" target="_blank" rel="noopener noreferrer">Shaw et al. 2021 ‚Äî PLOS ONE</a></p>
      <blockquote>
        ‚ÄúAnglers were observed to be about 10‚Äì12% more likely to be successful when the moon was overhead or underfoot‚Ä¶‚Äù
        <br><br>
        <em>(PDF p.13)</em>
      </blockquote>

      <h3 id="var-moon-phase">Moon phase (L_phase)</h3>
      <p><strong>Research-backed:</strong> gibbous phases highest; quarter phases lowest (ordering used).</p>
      <p><strong>Calibrated:</strong> exact curve shape and phaseWeight magnitude (2.0).</p>
      <p><strong>Source (open access):</strong> <a href="https://journals.plos.org/plosone/article/file?id=10.1371/journal.pone.0257882&amp;type=printable" target="_blank" rel="noopener noreferrer">Shaw et al. 2021 ‚Äî PDF (printable)</a></p>
      <blockquote>
        ‚ÄúThe odds of a successful trip were highest during the gibbous phases‚Ä¶ and lowest during the quarter phases‚Ä¶‚Äù
        <br><br>
        <em>(PDF p.13)</em>
      </blockquote>

      <h3 id="var-low-light">Low-light / crepuscular timing (L_time)</h3>
      <p><strong>Research-backed:</strong> dusk and dawn are better than day; lower light improves success.</p>
      <p><strong>Calibrated:</strong> the maximum lift size and the exact dawn/dusk window used for scoring (see verification section for the window definition source).</p>
      <p><strong>Source (open access):</strong> <a href="https://journals.plos.org/plosone/article/file?id=10.1371/journal.pone.0257882&amp;type=printable" target="_blank" rel="noopener noreferrer">Shaw et al. 2021 ‚Äî PDF (printable)</a></p>
      <blockquote>
        ‚Äú‚Ä¶The predicted odds of a successful trip was highest at dusk ‚Ä¶ followed by dawn ‚Ä¶ and then day ‚Ä¶‚Äù
        <br><br>
        <em>(PDF p.8)</em>
      </blockquote>
      <blockquote>
        ‚Äú‚Ä¶increased as light conditions decreased (i.e., decreasing solar radiation and the diel periods of dawn or dusk relative to daytime).‚Äù
        <br><br>
        <em>(PDF p.25)</em>
      </blockquote>

      <h3 id="var-cloud-cover">Cloud cover (proxy for solar radiation) (part of L_time)</h3>
      <p><strong>Research-backed:</strong> mean daily solar radiation negatively affects trip success; authors treat solar radiation as influenced by cloud cover.</p>
      <p><strong>Calibrated:</strong> mapping cloud cover % to a small lift (we keep it conservative).</p>
      <p><strong>Implementation note:</strong> PrimeBite uses Open‚ÄëMeteo cloud cover (%) as a proxy for light intensity, using a <strong>daytime average</strong> (‚âà9am‚Äì3pm local) when available.</p>
      <p><strong>Source (open access):</strong> <a href="https://journals.plos.org/plosone/article/file?id=10.1371/journal.pone.0257882&amp;type=printable" target="_blank" rel="noopener noreferrer">Shaw et al. 2021 ‚Äî PDF (printable)</a></p>
      <blockquote>
        ‚ÄúMean daily solar radiation had a negative effect on walleye trip success‚Ä¶ The observed percent of successful trips tended to increase with decreasing solar intensity ‚Ä¶‚Äù
        <br><br>
        <em>(PDF p.11)</em>
      </blockquote>
      <blockquote>
        ‚ÄúSolar radiation is influenced by solar altitude as well as cloud cover‚Ä¶ Thus, mean daily solar radiation was assumed to represent cloud cover as well as seasonal or diel differences in solar intensity‚Ä¶‚Äù
        <br><br>
        <em>(PDF p.5)</em>
      </blockquote>

      <h3 id="var-overlap">Dawn/dusk overlap with bite windows (L_overlap)</h3>
      <p><strong>Research-backed:</strong> low-light periods improve success (Shaw 2021), so overlap with dawn/dusk is meaningful.</p>
      <p><strong>Calibrated:</strong> how overlap maps into points (ceiling 0.07) and the overlap mapping ceiling in the profile.</p>
      <p><strong>Verification source:</strong> civil twilight definition (NOAA/NWS) is used so ‚Äúdawn/dusk overlap‚Äù is a standard astronomical window.</p>

      <h3 id="var-seasonality">Seasonality multiplier (seasonMult)</h3>
      <p><strong>Research-backed:</strong> Walleye vulnerability/effort/catch commonly peak in spring and shift through the year in open-access regional sources.</p>
      <p><strong>Calibrated:</strong> monthly multipliers and the global cap (1.15) used to keep seasonality meaningful but not dominant.</p>
      <p><strong>Sources (open PDFs):</strong></p>
      <ul>
        <li><a href="https://www.researchgate.net/profile/Michael-Hansen-44/publication/233201382_Temporal_Profiles_of_Walleye_Angling_Effort_Harvest_Rate_and_Harvest_in_Northern_Wisconsin_Lakes/links/546389d30cf2cb7e9da989d6/Temporal-Profiles-of-Walleye-Angling-Effort-Harvest-Rate-and-Harvest-in-Northern-Wisconsin-Lakes.pdf" target="_blank" rel="noopener noreferrer">Deroba et al. 2007 ‚Äî Northern Wisconsin seasonality</a></li>
        <li><a href="https://digitalcommons.unl.edu/cgi/viewcontent.cgi?article=1063&amp;context=ncfwrustaff" target="_blank" rel="noopener noreferrer">Pope &amp; Willis 1996 ‚Äî seasonal CPUE patterns</a></li>
      </ul>

      <h3 id="var-weather">Weather (wind/precip/pressure)</h3>
      <p><strong>Research-backed (decision to exclude):</strong> Shaw 2021 highlights wind direction (not wind speed) as highly weighted; precip/pressure were not highly weighted.</p>
      <p><strong>Calibrated/product choice:</strong> Walleye v1 does not apply wind/precip/pressure adjustments globally until effect sizes and generality are better supported.</p>

      <h2 id="verification">Key definitions & verification sources</h2>
      <p>
        Some items are not ‚ÄúWalleye biology claims‚Äù ‚Äî they are definitions needed for correct implementation.
      </p>

      <h3>Moon phase vs illuminated fraction</h3>
      <p><strong>Why it matters:</strong> quarter phases can have similar illumination but different phase position; the Walleye phase model is based on phase position.</p>
      <p><strong>Source (open access):</strong> <a href="https://classic.yarnpkg.com/en/package/suncalc" target="_blank" rel="noopener noreferrer">SunCalc docs (phase definition)</a></p>
      <blockquote>
        ‚ÄúMoon phase value should be interpreted like this: ‚Ä¶ 0 | New Moon ‚Ä¶ 0.25 | First Quarter ‚Ä¶ 0.5 | Full Moon ‚Ä¶ 0.75 | Last Quarter ‚Ä¶‚Äù
      </blockquote>

      <h3>Dawn/dusk window definition (¬±30 minutes)</h3>
      <p><strong>Used for:</strong> the low-light window used by Walleye v1.</p>
      <p><strong>Source (open access):</strong> <a href="https://minds.wisconsin.edu/handle/1793/85172" target="_blank" rel="noopener noreferrer">Vasquez 2024 ‚Äî UWSP thesis</a></p>
      <blockquote>
        ‚ÄúObservations 30 mins before and after sunrise were classified as dawn and observations 30 mins before and after sunset were classified as dusk.‚Äù
        <br><br>
        <em>(printed p.30)</em>
      </blockquote>

      <h3>Civil twilight definition (sun altitude ‚àí6¬∞)</h3>
      <p><strong>Used for:</strong> computing overlap_fraction for the overlap lift.</p>
      <p><strong>Source (open access):</strong> <a href="https://www.weather.gov/fsd/twilight" target="_blank" rel="noopener noreferrer">NWS/NOAA ‚Äî Twilight definitions</a></p>
      <blockquote>
        ‚ÄúMorning civil twilight begins when the geometric center of the sun is 6 degrees below the horizon, and ends at sunrise.
        Evening civil twilight begins at sunset, and ends when the geometric center of the sun is 6 degrees below the horizon.‚Äù
      </blockquote>

      <h2 id="example">Worked example (inputs ‚Üí lifts ‚Üí rating)</h2>
      <p>
        This is a ‚Äúmath-complete‚Äù example showing how the model reaches a high rating under strong conditions.
        Real outputs depend on the actual window timings and local sunrise/sunset.
      </p>

      <h3>Example: strong Major window (can approach 5.0/5)</h3>
      <ul>
        <li><strong>Major</strong> window: L_base = 0.10</li>
        <li><strong>Peak gibbous</strong> phase: L_phase ‚âà 0.05 (calibrated magnitude)</li>
        <li><strong>Full civil twilight overlap</strong>: overlap_fraction = 1.0 ‚Üí L_overlap = 0.07</li>
        <li><strong>Max low-light</strong>: L_time_lowlight = (0.20 / 0.40) √ó 0.03 = 0.015</li>
        <li><strong>Cloud cover</strong> = 100%: L_time_clouds = (0.05 / 0.40) √ó 0.03 ‚âà 0.004</li>
        <li><strong>Sum</strong>: L_total_raw ‚âà 0.10 + 0.05 + 0.07 + 0.015 + 0.004 = 0.239</li>
        <li><strong>Season</strong>: May seasonMult = 1.15 ‚Üí L_total ‚âà 0.239 √ó 1.15 = 0.275</li>
        <li><strong>Rating</strong>: 1 + 4 √ó (0.275 / 0.28) ‚âà <strong>4.9/5</strong></li>
      </ul>

      <h2 id="changelog">Model changelog (Walleye)</h2>
      <ul>
        <li><strong>2026-01</strong>: Published Walleye full transparency page (this page) and linked it from the app.</li>
        <li><strong>2026-01</strong>: Implemented civil-twilight overlap (definition-based dawn/dusk overlap, not arbitrary minutes) when lat/lon are available.</li>
        <li><strong>2026-01</strong>: Added a small dusk-over-dawn weighting and a conservative cloud-cover proxy term (direction research-backed; mapping calibrated).</li>
        <li><strong>2026-01-23</strong>: Research decision: Walleye uses <strong>Majors only</strong> (moon overhead/underfoot). Minor (moonrise/moonset) windows are not modeled.</li>
        <li><strong>2026-01-23</strong>: Commercial/UI: added <strong>percentile mapping</strong> for Major-window display ratings so 1.0 and 5.0 are equally rare (raw-model math remains visible).</li>
        <li><strong>2026-01-23</strong>: UI: redesigned Walleye ‚ÄúWhy this rating‚Äù to be <strong>window-first</strong> (each Major window has its own raw-model breakdown + mapping).</li>
      </ul>

      <h2>Canonical doc source</h2>
      <p>
        The canonical version of this content lives in the PrimeBite app repository docs (and is mirrored here for public transparency):
      </p>
      <ul>
        <li><code>docs/WALLEYE_CALCULATIONS.md</code></li>
        <li><code>docs/WALLEYE_VARIABLES_FACTCHECK.md</code></li>
      </ul>

      <div class="footer">
        PrimeBite Fishing ‚Äî Transparency pages are living documents. If you spot an error, please report it.
      </div>
    </div>
  </main>

  <button class="print-button" onclick="window.print()" aria-label="Print this page">
    üìÑ Print / Save PDF
  </button>

  <script>
    // Update TOC to include variable anchor links
    document.addEventListener('DOMContentLoaded', function() {
      const variablesSection = document.querySelector('.toc a[href="#variables"]').parentElement;
      if (variablesSection && variablesSection.tagName === 'LI') {
        const subList = document.createElement('ul');
        subList.style.marginLeft = '20px';
        subList.style.fontSize = '0.9em';
        subList.innerHTML = `
          <li><a href="#var-moon-position">Moon position (Majors only)</a></li>
          <li><a href="#var-moon-phase">Moon phase</a></li>
          <li><a href="#var-low-light">Low-light / crepuscular</a></li>
          <li><a href="#var-cloud-cover">Cloud cover</a></li>
          <li><a href="#var-overlap">Dawn/dusk overlap</a></li>
          <li><a href="#var-seasonality">Seasonality</a></li>
          <li><a href="#var-weather">Weather (disabled)</a></li>
        `;
        variablesSection.appendChild(subList);
      }
    });
  </script>
</body>
</html>
